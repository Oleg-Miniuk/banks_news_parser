//release 20180821-1047

("undefined"!=typeof vishnuJQuery?vishnuJQuery:jQuery)(function(){("undefined"!=typeof vishnuJQuery?vishnuJQuery:jQuery)("body").append('<div style="display:none;" class="vishnu-container"></div><div id="vishnu-button" style="display:none;"></div>')}),function(u){var e=vishnuSettings.loader;function t(){return!e.debugMode&&!e.testMode}u.fn.vishnu.uuid=e.uuid,u.fn.vishnu.View.prototype.classUserMessage=".vishnu-user-message",u.fn.vishnu.View.prototype.classInfMessage=".vishnu-inf-message",u.fn.vishnu.View.prototype.defaultInputText="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u0432\u043e\u043f\u0440\u043e\u0441",u.fn.vishnu.View.prototype.idButton="#vishnu-button",u.fn.vishnu.View.prototype.idResponse="#vishnu-response",u.fn.vishnu.View.prototype.idRequestWrap="#vishnu-request-wrap",u.fn.vishnu.View.prototype.idButtonText="",u.fn.vishnu.View.prototype.isScrollable=!1,u.fn.vishnu.View.prototype.response_scrolled=null,u.fn.vishnu.View.prototype.response_mCSBcontainer=null,u.fn.vishnu.View.prototype.requestIsScrollable=!1,u.fn.vishnu.View.prototype.requestLineHeightDy=20,u.fn.vishnu.View.prototype.request_scrolled=null,u.fn.vishnu.View.prototype.request_mCSBcontainer=null,u.fn.vishnu.VishnuEvent.srvReq={OPERATOR_SESSION_CLOSED:"SRVREQ 48f67fe9-3872-4bf6-8a6b-d3899b24b04a OPERATOR_SESSION_CLOSED"},u.fn.vishnu.Model.prototype.operators=null,u.fn.vishnu.Model.prototype.chatState=null,u.fn.vishnu.Event.prototype.OPERATOR_STATUS="4e729f9a-0aa2-4d37-87d2-bed2b2b39c00",u.fn.vishnu.OperatorStatus={online:1,offline:0,breakForm:13},u.fn.vishnu.ChatStatus={process:1,success:2,queue:3,operatorEnd:4,userEnd:5},u.fn.vishnu.settings[u.fn.vishnu.uuid]={debugMode:!t(),Model:{params:{vars:void 0!==vishnuSettings.clientConfig?vishnuSettings.clientConfig:""}},View:{noCharacter:!1,visible:!1,isScrollable:!0,requestIsScrollable:!1,template:'<div id="vishnu-header"><div id="vishnu-view"></div><span class="name">\u0412\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u043c\u043e\u0449\u043d\u0438\u043a</span><span class="name-op">\u0412\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u043c\u043e\u0449\u043d\u0438\u043a</span><span class="vishnu-decription">\u041e\u0442\u0432\u0435\u0442\u044b \u043d\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 24/7</span><span class="vishnu-decription-op">\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440-\u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442</span><div id="vishnu-close"></div></div><div id="vishnu-dialog"><div id="vishnu-response"><div id="vishnu-response-wrap"><div id="vishnu-response-text"></div></div></div><div id="vishnu-request"><div id="vishnu-request-wrap"><textarea id="vishnu-input" spellcheck="false" maxlength="1000"></textarea></div><button id="vishnu-send"></button></div></div>',hideAuto:!1},Net:{type:u.fn.vishnu.ConnectionType.SYNC,url:t()?"https://biz.nanosemantics.ru/api/2.1/json/":"http://biz-debug.nanosemantics.ru/api/2.1/json/"},Rate:{enabled:!0,closeTimeout:15e3,template:'<div id="vishnu-rate" style="display:none;"><div id="vishnu-rate-text">\u041c\u043e\u0439 \u043e\u0442\u0432\u0435\u0442 \u043f\u043e\u043b\u0435\u0437\u0435\u043d \u0432\u0430\u043c?</div><div id="vishnu-rate-yes">\u0414\u0430</div><div id="vishnu-rate-no">\u041d\u0435\u0442</div><div id="vishnu-rate-close"></div><div id="vishnu-rate-details">&mdash; <a href="#" rel="3">\u042f \u0441\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u043b(-\u0430) \u043f\u0440\u043e \u0434\u0440\u0443\u0433\u043e\u0435</a><br />&mdash; <a href="#" rel="2">\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u0432 \u043e\u0444\u0438\u0441 \u0411\u0430\u043d\u043a\u0430</a><br />&mdash; <a href="#" rel="1">\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u0432 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0439 \u0446\u0435\u043d\u0442\u0440</a></div><div id="vishnu-rate-thanks"></div></div>'},Tracker:{account:""},History:{enabled:!0,useFlashStorage:!1,useLocalStorage:!0},LCEModel:{enabled:!0,scriptEvAdapterLocation:(t(),"adapter.js"),sendLogWithRequiresOperator:!1,queueTimeout:18e4,idOperatorName:"#vishnu-header > .name-op",returnToVishnu:function(e){if(!this.rateShown&&this.isLiveChatReady){console.log("\u041f\u0415\u0420\u0415\u0425\u0412\u0410\u0427\u0415\u041d\u041e: "+u.fn.vishnu.VishnuEvent.SWITCH_TO_VISHNU+" DATA: ",e),$model=this.Vishnu.getModel(),$model.mode(u.fn.vishnu.VishnuModes.INF),this.isLiveChatReady=!1;var t=this.operatorName?this.operatorName:"";"queueTimeout"!==e.status&&(this.onMessage({message:this.TEHmessage.dialogEnd.replace("%NAME",t)}),this.savePrevTehMessage=!0),this.onMessage({message:this.TEHmessage.operatorChange.replace("%NAME","\u041f\u0451\u0442\u0440")}),this.setLiveChatDesign(!1)}},TEHmessage:{noOperators:"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0432\u0441\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0437\u0430\u043d\u044f\u0442\u044b.",operatorIsTyped:"\u041f\u0435\u0447\u0430\u0442\u0430\u0435\u0442 ",queueTime:"",operatorChange:"\u0412\u0430\u0448 \u0434\u0438\u0430\u043b\u043e\u0433 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443 <strong>%NAME</strong>",infChange:"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442\u0443 \u041f\u0451\u0442\u0440",operatorProcess:"",dialogEnd:"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 %NAME \u0437\u0430\u043a\u0440\u044b\u043b \u0434\u0438\u0430\u043b\u043e\u0433",file:"\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d \u0444\u0430\u0439\u043b: %FILE",log:"\u0414\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0434\u0438\u0430\u043b\u043e\u0433\u0430 \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435: %FILE"},uploadEnable:!1,showRateBeforeQuit:!1,debugIntergtaion:!1}},u.fn.vishnu.View.prototype.initOperatorRate=function(){if(!(0<u(this.idOperatorRate,this.container).length)){this.stop_announce=!0,this.blockTextarea(!0),this.Cookie.hasCookie("operatorRateShow")||this.Cookie.setCookie("operatorRateShow",1,365);var e=u(this.operatorRateForm.tpl.replace("{%helloText}",this.operatorRateForm.helloText).replace("{%thanksText}",this.operatorRateForm.thanksText));this.isScrollable?u(this.response_mCSBcontainer).append(e):u(this.idResponseText,this.container).append(e),u(this.idOperatorRate,this.idResponseText,this.container).show(),this.updateHeight(this.response_scrolled,u(this.idOperatorRate,this.idResponseText,this.container)),u(this.classOperatorRateStar,this.idOperatorRate,this.container).on("mouseenter",this._operatorRateHandlers.hover.bind(this)),u(this.classOperatorRateStar,this.idOperatorRate,this.container).on("click",this._operatorRateHandlers.click.bind(this)),u(this.idOperatorRate,this.container).show()}};var i=u.fn.vishnu.Vishnu.prototype.init;u.fn.vishnu.Vishnu.prototype.init=function(e){"1"==localStorage.getItem("history_loaded")&&localStorage.removeItem("history_loaded"),u.fn.vishnu.instancesCount=0,($this=this).on(u.fn.vishnu.VishnuEvent.DRAW,function(){var t=$this.getView();if(u(t.idButton).text(t.idButtonText),head.ready(function(){$this.log("LOADER: \u0432\u0441\u0435 \u0441\u0442\u0438\u043b\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b"),u(t.idButton).removeAttr("style")}),t.isScrollable&&(t.response_scrolled=u(t.idResponseText,t.container),u(t.idResponseText,t.container).mCustomScrollbar({axis:"y",theme:"dark",autoDraggerLength:!1,alwaysShowScrollbar:1,callbacks:{onCreate:function(){var e=u(this).data("mCS").idx;t.response_mCSBcontainer=u("#mCSB_"+e+"_container",t.container)}}})),t.requestIsScrollable){t.request_scrolled=u(t.idRequestWrap,t.container);var e=parseInt(u(".textarea-wrapper textarea").css("line-height"));u(t.idInput,t.container).after('<div class="textarea-clone"><div>'),u(t.idRequestWrap,t.container).mCustomScrollbar({axis:"y",scrollInertia:0,snapAmount:e,mouseWheel:!0,autoHideScrollbar:!1,callbacks:{onCreate:function(){var e=u(this).data("mCS").idx;t.request_mCSBcontainer=u("#mCSB_"+e+"_container",t.container)}}})}}),u.fn.vishnu.Cookie.prototype.setCookie=function(e,t,i){if(i){var s=new Date;s.setTime(s.getTime()+24*i*60*60*1e3);var n="; expires="+s.toGMTString()}else n="";document.cookie=this.prefix+e+"="+t+n+"; path=/"},this.on(u.fn.vishnu.VishnuEvent.HISTORY_LOADED,function(e,t){if(t&&void 0!==t&&$this.getView().isScrollable){for(var i,s=u($this.getView().response_mCSBcontainer,$this.getView().container).find(".vishnu-last-message"),n=!1,o=0;o<t.length;o++)if(t[o]&&void 0!==t[o])if(t[o].inf&&void 0!==t[o].inf){if(i=$this.getView().replaceMarks(t[o].inf),o==t.length-1&&void 0!==s.html()&&null!==s.html()&&i.replace(/<\/?[^>]+>/g,"")==s.html().replace(/<\/?[^>]+>/g,""))break;$this.getView().addInfMessage(i,0),n=!0}else t[o].user&&void 0!==t[o].user&&(i=t[o].user,$this.getView().addUserMessage(i,0),n=!0);var a=$this.getView().response_mCSBcontainer,r=s.parents(".vishnu-response-message:first"),h=r.next(".vishnu-empty-box");void 0!==s&&n&&(a.find(".vishnu-inf-message").removeClass("vishnu-last-message"),s.addClass("vishnu-last-message"),r.insertAfter(a.children().last()),h.insertAfter(r)),localStorage.setItem("history_loaded",1),$this.getView().updateHeight(u($this.getView().response_scrolled),"bottom")}$this.Cookie.hasCookie("operatorRateShow")&&$this.getView().initOperatorRate()}),this.on(u.fn.vishnu.VishnuEvent.REQUEST,function(e,t){$this.LCEModel&&$this.LCEModel.rateShown||$this.getView().addUserMessage(t)}),this.on(u.fn.vishnu.VishnuEvent.SHOW,function(){$this.getView().updateHeight(u($this.getView().response_scrolled),"bottom",0)}),i.apply(this,arguments),this.on(u.fn.vishnu.VishnuEvent.V3G_OPERATOR_CHAT_RATED,function(e,t){$this.getModel().sendEvent("c189c2f1-43b6-424b-866b-03e562ba9d33",{status:4})}),u.fn.vishnu.settings[u.fn.vishnu.uuid].LCEModel.enabled&&this.getLCEModel().init(u.fn.vishnu.settings[u.fn.vishnu.uuid].LCEModel)},u.fn.vishnu.Vishnu.prototype.getLCEModel=function(){return this.LCEModel||(this.LCEModel=new u.fn.vishnu.LCEModel(this)),this.LCEModel},u.fn.vishnu.Model.prototype.init=function(e){for(var t in e)t in this&&(this[t]=e[t]);this.Cookie||(this.Cookie=this.Vishnu.getCookie()),this.Storage||(this.Storage=this.Vishnu.getStorage()),this.Net||(this.Net=this.Vishnu.getNet()),this.History||(this.History=this.Vishnu.getHistory()),this.Event||(this.Event=new u.fn.vishnu.Event);var i=this;this.Net.onInit(function(e){i.onInit(e)}),this.Net.onResponse(function(e){i.onResponse(e)}),this.Net.onEvent(function(e,t){i.onEventResponse(e,t)}),this.Net.onRate(function(e){i.onRateResponse(e)}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.REQUEST,function(e,t){i.mode()===u.fn.vishnu.VishnuModes.INF&&i.sendRequest(t)}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.LINK_CLICK,function(e,t){i.sendClick(t)}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.LINK_TRACK,function(e,t){i.Net.sendTrack(i.getUUID(),i.getCUID(),t)});var s=this,n=this,o=this.Vishnu.getView();this.Vishnu.on(u.fn.vishnu.VishnuEvent.SHOW,function(e){if(!i.initAlreadySended){if(n.paramsInit)n.Net.sendInit(n.getUUID(),n.getCUID(),n.paramsInit),n.Vishnu.trigger("__SEND_INIT__",n.paramsInit);else{var t={};void 0!==n.paramsInit&&(t=u.extend(!0,{},t,n.paramsInit)),n.params&&n.params.hasOwnProperty("vars")&&void 0!==n.params.vars&&(t=u.extend(!0,{},t,n.params.vars)),n.Net.sendInit(n.getUUID(),n.getCUID(),t),n.Vishnu.trigger("__SEND_INIT__",t)}i.initAlreadySended=!0}o.hideAuto&&(s.hideEvent||(s.hideEvent=new u.fn.vishnu.Event),s.hideEvent.initInactiveTimer(function(){u(o.idInput,o.container).is(":focus")?s.hideEvent.clearInactiveTimer():(o.hideVishnu(),s.hideEvent.destroyInactiveTimer())},o.hideTimeout))}),o.hideAuto&&(this.Vishnu.on(u.fn.vishnu.VishnuEvent.USER_ACTIVITY,function(){s.hideEvent.clearInactiveTimer()}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.REQUEST,function(){s.hideEvent.clearInactiveTimer()}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.RESPONSE,function(){s.hideEvent.clearInactiveTimer()}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.RATE,function(){s.hideEvent.clearInactiveTimer()}),this.Vishnu.on(u.fn.vishnu.VishnuEvent.HIDE,function(){s.hideEvent.clearInactiveTimer()}))};var s=u.fn.vishnu.Model.prototype.onInit;u.fn.vishnu.Model.prototype.onInit=function(e){s.apply(this,arguments),this.Cookie.getCookie("new_chat")&&this.Vishnu.getHistory().clean();var i=this;this.Vishnu.on("nns_v3g_livechatStatusRequested",function(e,t){i.Vishnu.log("[...->V3G]: "),i.Vishnu.log(t),t&&t.hasOnlineOperators&&0<t.freeOperatorsCount?(u.fn.vishnu.Model.prototype.operators=1,i.operators=1):(u.fn.vishnu.Model.prototype.operators=0,i.operators=0),i.sendEvent(i.Event.OPERATOR_STATUS,{status:1==i.operators?u.fn.vishnu.OperatorStatus.online:u.fn.vishnu.OperatorStatus.offline})})},u.fn.vishnu.Model.prototype.processingVar=function(e,t){if("object"==typeof e)switch(t){case"Model":e.context&&e.context.hasOwnProperty("preliveperson")&&(this.Vishnu.Model.Event.destroyInactiveTimer(),this.Vishnu.trigger("nns_v3g_switchToOperatorRequested")),e.context&&e.context.hasOwnProperty("liveperson")&&this.mode(1==1*e.context.liveperson?u.fn.vishnu.VishnuModes.LIVE_CHAT:u.fn.vishnu.VishnuModes.INF);break;case"Rate":e.context&&void 0!==e.context.inline_message&&(u(this.idRate,this.container).is(":visible")&&u(this.idRate,this.container).after('<div class="vishnu-empty-box"><p><br/></p></div>'),this.Vishnu.getView().setText(text,e)),e.context&&void 0!==e.context.inline_message&&u($this.idRate).next(".vishnu-empty-box").remove();break;default:return}},u.fn.vishnu.Model.prototype.onResponse=function(e,t,i){if(e){e.isEvent=void 0!==t&&t,e.euid=i,!e.isEvent&&e.cuid&&this.setCUID(e.cuid);this.mode();u.fn.vishnu.VishnuModes.INF!==this.mode()&&void 0!==this.mode()||e.context.hasOwnProperty("liveperson")||this.Vishnu.trigger(u.fn.vishnu.VishnuEvent.RESPONSE,e),e.context&&this.processingVar(e,"Model")}else this.Vishnu.track(["_trackEvent","Error","Bad response"])};var n=u.fn.vishnu.View.prototype.draw;u.fn.vishnu.View.prototype.draw=function(){n.apply(this,arguments);var i=this;u(this.idInput,this.container).unbind("keypress");var s=this.defaultInputText;u(this.idInput,this.container).keypress(function(e){if(u(this).val()===s&&(u(this).val(""),u(this).removeClass("vishnu-placeholder-default")),13===e.keyCode){e.preventDefault(),i._sendRequest();var t=u(this);setTimeout(function(){t.click()},10)}return i.Vishnu.trigger(u.fn.vishnu.VishnuEvent.USER_ACTIVITY),u(this).val().length<=u(this).attr("maxlength")}).val(s).addClass("vishnu-placeholder-default").click(function(){u(this).val()===s&&(u(this).val(""),u(this).removeClass("vishnu-placeholder-default"))}).focus(),u(this.idInput,this.container).unbind("blur"),u(this.idInput,this.container).on("blur",function(e){u(this).val().length||u(this).addClass("vishnu-placeholder-default").val(s).focus()}),u(this.idInput,this.container).keyup(function(e){u(".textarea-clone").html(u(this).val()),u(this).css("height",u(".textarea-clone").height()),i.updateHeight(u(i.request_scrolled),"bottom")})},u.fn.vishnu.View.prototype.setText=function(e,t){this.isText(e)&&this.addInfMessage(e)},u.fn.vishnu.View.prototype.addInfMessage=function(e,t){t=void 0!==t?t:950;var i;return i=u('<div class="vishnu-response-message"><div class="vishnu-inf-message vishnu-last-message"><div class="vishnu-text">'+e+'</div></div></div><div class="vishnu-empty-box"><p><br/></p></div>'),this.isScrollable?(u(this.classInfMessage,this.idResponseText,this.container).removeClass("vishnu-last-message"),u(this.response_mCSBcontainer).append(i),this.updateHeight(this.response_scrolled,u(this.classInfMessage+".vishnu-last-message",this.idResponseText,this.container),t)):(u(this.idResponseText,this.container).removeClass("vishnu-last-message"),u(this.idResponseText,this.container).html(i)),i},u.fn.vishnu.View.prototype.addUserMessage=function(e,t){if(this.isScrollable){e=u("<div/>").text(e).html(),t=void 0!==t?t:950;var i;return i=u('<div class="vishnu-response-message"><div class="vishnu-user-message vishnu-last-message"><div class="vishnu-text">'+e+'</div></div></div><div class="vishnu-empty-box"><p><br/></p></div>'),this.isScrollable?(u(this.classUserMessage,this.idResponseText,this.container).removeClass("vishnu-last-message"),u(this.response_mCSBcontainer).append(i),this.updateHeight(this.response_scrolled,"bottom",0)):(u(this.idResponseText,this.container).removeClass("vishnu-last-message"),u(this.idResponseText,this.container).html(i)),i}},u.fn.vishnu.View.prototype.addTehMessage=function(e,t,i){i=void 0!==i&&i,e=u("<div/>").html(e).html(),t=void 0!==t?t:10;var s;return s=u('<div class="vishnu-response-message"><div class="vishnu-teh-message vishnu-last-message"><div class="vishnu-text">'+e+"</div></div></div>"),this.isScrollable&&(u(".vishnu-teh-message",this.idResponseText,this.container).removeClass("vishnu-last-message"),u(this.response_mCSBcontainer).find(".vishnu-response-message:last > .vishnu-teh-message").length&&!i?u(this.response_mCSBcontainer).find(".vishnu-response-message:last").replaceWith(s):u(this.response_mCSBcontainer).append(s),this.updateHeight(this.response_scrolled,"bottom",0)),s},u.fn.vishnu.View.prototype.showTyping=function(e){},u.fn.vishnu.View.prototype.updateHeight=function(e,t,i){if("object"==typeof e){t=void 0!==t?t:"bottom",i="number"==typeof i?i:950,u(e).mCustomScrollbar("update"),u(e).mCustomScrollbar("scrollTo",t,{scrollInertia:i})}},u.fn.vishnu.Rate.prototype.show=function(){var e=this.Vishnu.getView();this.shown=!0,this.answered=!1,u(this.idRate,this.container).show(),e.isScrollable?(u(this.idRateText).html(this.defaultRateText),u(e.response_mCSBcontainer).append(u(this.idRate,this.container))):u(e.idResponseText,e.container).append(u(this.idRate,this.container)),e.updateHeight(e.response_scrolled,u(e.classInfMessage+".vishnu-last-message",e.idResponseText,e.container)),this.Vishnu.track(["_trackEvent","Inf","Rate","Show"])};var o=u.fn.vishnu.Rate.prototype.close;u.fn.vishnu.Rate.prototype.close=function(){o.apply(this,arguments),u(this.idRateText,this.container).show(),u(this.idRateClose,this.container).show(),u(this.idRateYes,this.container).show(),u(this.idRateNo,this.container).show(),this.Vishnu.getView().updateHeight()},u.fn.vishnu.Rate.prototype.showThanks=function(e){text=void 0!==e&&void 0!==e.text&&0<e.text.value.length?e.text.value:this.defaultThanksText,text=this.Vishnu.getView().replaceMarks(text,e.token),e.animation&&e.animation.type&&this.Vishnu.getView().playAnimation(e.animation),u(this.idRateDetails,this.container).is(":visible")&&u(this.idRateDetails,this.container).hide();var t=this,i=this.Vishnu.getModel();if(e.context&&i.processingVar(e,"Rate"),0===e.context.length){u(this.idRateText,this.container).hide(),u(this.idRateYes,this.container).hide(),u(this.idRateNo,this.container).hide(),u(this.idRateThanks,this.container).html(text).show();var s=e.token;u(this.idRateThanks,this.container).find(".vishnu-userlink").click(function(){return t.Vishnu.trigger(u.fn.vishnu.VishnuEvent.REQUEST,u(this).text()),t.Vishnu.track(["_trackEvent","Inf","Rate userlink click",u(this).text()]),!1}).end().find(".vishnu-click").click(function(){t.Vishnu.trigger(u.fn.vishnu.VishnuEvent.LINK_CLICK,s),t.Vishnu.track(["_trackEvent","Inf","Rate link click",u(this).attr("href")])}).each(function(){t.Vishnu.track(["_trackEvent","Inf","Rate link show",u(this).attr("href")])}),this.Vishnu.getView().updateHeight()}setTimeout(function(){t.close()},this.closeTimeout)},u.fn.vishnu.Rate.prototype.showDetails=function(){var e=this.Vishnu.getView();u(this.idRateDetails,this.container).show(),e.isScrollable?(u(this.idRateText).html(this.defaultRateText),u(e.response_mCSBcontainer).append(u(this.idRate,this.container))):u(e.idResponseText,e.container).append(u(this.idRate,this.container)),e.updateHeight(e.response_scrolled,u(this.idRate,this.container))},u.fn.vishnu.View.prototype.blockTextarea=function(e){var t=u(this.idRequest,this.container),i=u(this.idInput,this.container);e?(t.addClass("vishnu-blocked"),i.attr("disabled","disabled"),i.trigger("blur"),i.val("")):(t.removeClass("vishnu-blocked"),i.removeAttr("disabled"),i.trigger("focus"),i.trigger("click"),this.History.get())},u.fn.vishnu.View.prototype.idOperatorRate="#vishnu-operator-rate",u.fn.vishnu.View.prototype.idOperatorRateHelloTxt="#vishnu-operator-rate-text",u.fn.vishnu.View.prototype.classOperatorRateStar=".vishnu-star",u.fn.vishnu.View.prototype.classOperatorRateStarSel="selected",u.fn.vishnu.View.prototype.idOperatorRateThanksTxt="#vishnu-operator-rate-thanks",u.fn.vishnu.View.prototype.operatorRateHideTimeout=5e3,u.fn.vishnu.View.prototype.operatorRateForm={tpl:'<div id="vishnu-operator-rate" ><div id="vishnu-operator-rate-text">{%helloText}</div><div id="vishnu-operator-rate-details"><a href="#" class="vishnu-star" data-rate="1">1</a><a href="#" class="vishnu-star" data-rate="2">2</a><a href="#" class="vishnu-star" data-rate="3">3</a><a href="#" class="vishnu-star" data-rate="4">4</a><a href="#" class="vishnu-star" data-rate="5">5</a></div><div id="vishnu-operator-rate-thanks" style="display:none;">{%thanksText}</div></div>',helloText:"\u041f\u043e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043e\u0446\u0435\u043d\u043a\u0443 \u043f\u043e \u043f\u044f\u0442\u0438\u0431\u0430\u043b\u044c\u043d\u043e\u0439 \u0448\u043a\u0430\u043b\u0435",thanksText:"\u0421\u043f\u0430\u0441\u0438\u0431\u043e! \u041c\u044b \u0431\u0443\u0434\u0435\u043c \u0441\u0442\u0430\u0440\u0430\u0442\u044c\u0441\u044f \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u043d\u0430\u0448 \u0441\u0435\u0440\u0432\u0438\u0441"},u.fn.vishnu.View.prototype._operatorRateHandlers={hover:function(e){var t=e||t,i=u(t.target).data("rate"),s=this;u(this.classOperatorRateStar,this.idOperatorRate).removeClass(this.classOperatorRateStarSel),u(this.classOperatorRateStar,this.idOperatorRate).each(function(e,t){u(t).data("rate")<=i&&u(t).addClass(s.classOperatorRateStarSel)})},click:function(e){var t=e||t,i=this,s=u(t.target).data("rate");u(this.classOperatorRateStar,this.idOperatorRate,this.container).off("mouseenter"),this.Vishnu.trigger("toMibew::operatorRateSend",s),this.Vishnu.trigger(u.fn.vishnu.VishnuEvent.V3G_OPERATOR_CHAT_RATED,s),u(this.idOperatorRateThanksTxt,this.idOperatorRate).show(),this.updateHeight(this.response_scrolled,"bottom"),setTimeout(function(){i._operatorRateHandlers.close.apply(i)},i.operatorRateHideTimeout)},close:function(){u(this.idOperatorRate,this.container).off(),u(this.idOperatorRate,this.container).remove(),this.stop_announce=!1,this.blockTextarea(!1),this.Cookie.hasCookie("operatorRateShow")&&this.Cookie.setCookie("operatorRateShow",0,-1),this.Vishnu.getModel().INC.clearInactiveTimer(),this.updateHeight(this.response_scrolled,"bottom")}},u.fn.vishnu.View.prototype.initOperatorRate=function(){if(!(0<u(this.idOperatorRate,this.container).length)){this.stop_announce=!0,this.blockTextarea(!0),this.Cookie.hasCookie("operatorRateShow")||this.Cookie.setCookie("operatorRateShow",1,365);var e=u(this.operatorRateForm.tpl.replace("{%helloText}",this.operatorRateForm.helloText).replace("{%thanksText}",this.operatorRateForm.thanksText));this.isScrollable?u(this.response_mCSBcontainer).append(e):u(this.idResponseText,this.container).append(e),u(this.idOperatorRate,this.idResponseText,this.container).show(),this.updateHeight(this.response_scrolled,u(this.idOperatorRate,this.idResponseText,this.container)),u(this.classOperatorRateStar,this.idOperatorRate,this.container).on("mouseenter",this._operatorRateHandlers.hover.bind(this)),u(this.classOperatorRateStar,this.idOperatorRate,this.container).on("click",this._operatorRateHandlers.click.bind(this)),u(this.idOperatorRate,this.container).show()}}}("undefined"!=typeof vishnuJQuery?vishnuJQuery:jQuery);